(function(d){var a={watermark:{mode:"text",order:"foreground",position:"c",opacity:0.3,margin:10,text:"COPYRIGHT",color:"rgb(0, 0, 0)",font:"30px Arial",src:"watermark.png",scaling:1}};var f=undefined;function e(h){var g;h.hooks.processOptions.push(function(j,i){var i=i.watermark;if(i.order=="background"){g=j.hooks.drawBackground}else{if(i.order=="foreground"){g=j.hooks.draw}else{console.log("No valid order specified. Using foreground.");g=j.hooks.draw}}g.push(function(m,k){if(i.mode=="text"){c(m,k,i)}else{if(i.mode=="image"){var l=new Image();if(l.src==f){b(m,k,i,l)}else{l.onload=function(){f=l.src;b(m,k,i,l)};l.src=i.src}}else{return}}})})}function c(l,g,h){g.save();var n;var i;var m;var j=h.margin;if(j[0]==null){j=[j,j]}var k=l.getAxes();switch(h.position){case"nw":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.max});n=m.left+j[0];i=m.top+j[1];g.textAlign="left";g.textBaseline="top";break;case"n":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.max});n=m.left+l.width()/2;i=m.top+j[1];g.textAlign="center";g.textBaseline="top";break;case"ne":m=l.pointOffset({x:k.xaxis.max,y:k.yaxis.max});n=m.left-j[0];i=m.top+j[1];g.textAlign="right";g.textBaseline="top";break;case"e":m=l.pointOffset({x:k.xaxis.max,y:k.yaxis.max});n=m.left-j[0];i=m.top+l.height()/2;g.textAlign="right";g.textBaseline="middle";break;case"se":m=l.pointOffset({x:k.xaxis.max,y:k.yaxis.min});n=m.left-j[0];i=m.top-j[1];g.textAlign="right";g.textBaseline="bottom";break;case"s":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.min});n=m.left+l.width()/2;i=m.top-j[1];g.textAlign="center";g.textBaseline="bottom";break;case"sw":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.min});n=m.left+j[0];i=m.top-j[1];g.textAlign="left";g.textBaseline="bottom";break;case"w":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.max});n=m.left+j[0];i=m.top+l.height()/2;g.textAlign="left";g.textBaseline="middle";break;case"c":m=l.pointOffset({x:k.xaxis.min,y:k.yaxis.max});n=m.left+l.width()/2;i=m.top+l.height()/2;g.textAlign="center";g.textBaseline="middle";break;default:console.log("No valid position specified.")}g.globalAlpha=h.opacity;g.font=h.font;g.fillStyle=h.color;g.fillText(h.text,n,i);g.restore()}function b(l,o,p,j){o.save();var g=j.width;var n=j.height;var k;var h;var i=p.margin;if(i[0]==null){i=[i,i]}var m=l.getAxes();switch(p.position){case"nw":offset=l.pointOffset({x:m.xaxis.min,y:m.yaxis.max});k=offset.left+i[0];h=offset.top+i[1];break;case"n":offset=l.pointOffset({x:m.xaxis.max,y:m.yaxis.max});k=offset.left-l.width()/2-p.scaling*g/2;h=offset.top+i[1];break;case"ne":offset=l.pointOffset({x:m.xaxis.max,y:m.yaxis.max});k=offset.left-p.scaling*g-i[0];h=offset.top+i[1];break;case"e":offset=l.pointOffset({x:m.xaxis.max,y:m.yaxis.max});k=offset.left-p.scaling*g-i[0];h=offset.top+l.height()/2-p.scaling*n/2;break;case"se":offset=l.pointOffset({x:m.xaxis.max,y:m.yaxis.min});k=offset.left-p.scaling*g-i[0];h=offset.top-p.scaling*n-i[1];break;case"s":offset=l.pointOffset({x:m.xaxis.min,y:m.yaxis.min});k=offset.left+l.width()/2-p.scaling*g/2;h=offset.top-p.scaling*n-i[1];break;case"sw":offset=l.pointOffset({x:m.xaxis.min,y:m.yaxis.min});k=offset.left+i[0];h=offset.top-p.scaling*n-i[1];break;case"w":offset=l.pointOffset({x:m.xaxis.min,y:m.yaxis.max});k=offset.left+i[0];h=offset.top+l.height()/2-p.scaling*n/2;break;case"c":offset=l.pointOffset({x:m.xaxis.min,y:m.yaxis.max});k=offset.left+l.width()/2-p.scaling*g/2;h=offset.top+l.height()/2-p.scaling*n/2;break;default:console.log("No valid position.")}o.globalAlpha=p.opacity;o.drawImage(j,k,h,p.scaling*g,p.scaling*n);o.restore()}d.plot.plugins.push({init:e,options:a,name:"Watermark",version:"1.0.1"})})(jQuery);